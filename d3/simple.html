<html>
  <head>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script>
      function genBuyData() {
        var x = Math.random() * 10
        var y = Math.random() * 70
        return [ [x, 100], [x + 10, y], [x + 20, y / 2] ]
      }

      function genSellData() {
        var x = Math.random() * 10
        var y = Math.random() * 50
        return [ [30 + x, y / 2], [30 + x + 10, y], [30 + x + 20, 100 + y] ]
      }
    </script>
    <style>
      svg rect {
        fill: steelblue;
      }
      svg text {
        fill: white;
        font: 10px sans-serif;
        text-anchor: middle;
      }
    </style>
  </head>
  <body>
    <div id="chart" style="width: 100%; height: 400px;">
      <svg width="100%" height="100%"></svg>
    </div>

    <script>
      d3.select("#chart").style("border", "1px solid black")

      var buyData = genBuyData()
      var sellData = genSellData()

      var boundingRect = d3.select("#chart").node().getBoundingClientRect()

      var minX = d3.min(buyData, d => d[0])
      var maxX = d3.max(sellData, d => d[0])
      var maxY = d3.max([d3.max(buyData, d => d[1]), d3.max(sellData, d => d[1])])
      var padding = 20
      
      console.log(`X [${minX}, ${maxX}] [0, ${boundingRect.width}]`)
      console.log(`Y [0, ${maxY}] [0, ${boundingRect.height}]`)

      var x = d3.scaleLinear()
                .range([padding, boundingRect.width - padding])
                .domain([minX, maxX])

      var y = d3.scaleLinear()
                .range([padding, boundingRect.height - padding])
                .domain([0, maxY])

      // BUY

      var buyBars = d3.select("svg")
                    .selectAll("rect")
                    .data(buyData)

      buyBars.enter().append("rect")
        .attr('y', d => y(maxY - d[1]))
        .attr('x', d => x(d[0]))
        .attr("width", 5)
        .attr("height", d => y(d[1]))

      buyBars.exit().remove()

      // SELL

      var sellBars = d3.select("svg")
                    .selectAll("rect")
                    .data(sellData)

      sellBars.enter().append("rect")
        .attr('y', d => y(maxY - d[1]))
        .attr('x', d => x(d[0]))
        .attr("width", 5)
        .attr("height", d => y(d[1]))

      sellBars.exit().remove()
    </script>
  </body>
</html>